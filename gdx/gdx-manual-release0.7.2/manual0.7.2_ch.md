# Go DxChain 教程

官方 Golang 版本的 DxChain 协议实现

`gdx`是建立在DxChain协议之上的项目。DxChain是一个基于P2P网络的数据存储区块链。DX的核心功能是用户可以成为上传并存储数据的存储委托方或者是为他人提供存储空间和服务的存储提供方。另外，DxChain也包括支持其他区块链支持的功能，如分散式账本或者智能合约。

 本文档将介绍每个节点在DxChain区块链中可以成为的角色和可以使用的功能。在您尝试DX的功能之前，请仔细阅读[第一部分：准备工作](#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C)。
 
 如果您想要成为一名矿工，请点击[这里](#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%E7%9F%BF%E5%B7%A5)。
 
 如果您想要成为一名存储委托方，请点击[这里](#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E5%AD%98%E5%82%A8%E5%A7%94%E6%89%98%E6%96%B9)。
 
 如果您想要成为一名存储提供方，请点击[这里](#%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%E5%AD%98%E5%82%A8%E6%8F%90%E4%BE%9B%E6%96%B9)。


 ## 目录
- [Go DxChain 教程](#go-dxchain-%e6%95%99%e7%a8%8b)
  - [第一部分：准备工作](#%e7%ac%ac%e4%b8%80%e9%83%a8%e5%88%86%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c)
    - [步骤1.1 获取`gdx`可执行文件](#%e6%ad%a5%e9%aa%a411-%e8%8e%b7%e5%8f%96gdx%e5%8f%af%e6%89%a7%e8%a1%8c%e6%96%87%e4%bb%b6)
    - [步骤1.2 迁移`gdx`可执行文件](#%e6%ad%a5%e9%aa%a412-%e8%bf%81%e7%a7%bbgdx%e5%8f%af%e6%89%a7%e8%a1%8c%e6%96%87%e4%bb%b6)
    - [步骤1.3 验证`gdx`可执行文件](#%e6%ad%a5%e9%aa%a413-%e9%aa%8c%e8%af%81gdx%e5%8f%af%e6%89%a7%e8%a1%8c%e6%96%87%e4%bb%b6)
    - [步骤1.4 获取执行权限](#%e6%ad%a5%e9%aa%a414-%e8%8e%b7%e5%8f%96%e6%89%a7%e8%a1%8c%e6%9d%83%e9%99%90)
    - [步骤1.5 验证版本](#%e6%ad%a5%e9%aa%a415-%e9%aa%8c%e8%af%81%e7%89%88%e6%9c%ac)
  - [第二部分：矿工](#%e7%ac%ac%e4%ba%8c%e9%83%a8%e5%88%86%e7%9f%bf%e5%b7%a5)
    - [步骤2.1 开启节点](#%e6%ad%a5%e9%aa%a421-%e5%bc%80%e5%90%af%e8%8a%82%e7%82%b9)
    - [步骤2.2 开启`gdx`控制台](#%e6%ad%a5%e9%aa%a422-%e5%bc%80%e5%90%afgdx%e6%8e%a7%e5%88%b6%e5%8f%b0)
    - [步骤2.3 创建账号并开始挖矿](#%e6%ad%a5%e9%aa%a423-%e5%88%9b%e5%bb%ba%e8%b4%a6%e5%8f%b7%e5%b9%b6%e5%bc%80%e5%a7%8b%e6%8c%96%e7%9f%bf)
    - [步骤2.4 停止挖矿](#%e6%ad%a5%e9%aa%a424-%e5%81%9c%e6%ad%a2%e6%8c%96%e7%9f%bf)
  - [第三部分：存储委托方](#%e7%ac%ac%e4%b8%89%e9%83%a8%e5%88%86%e5%ad%98%e5%82%a8%e5%a7%94%e6%89%98%e6%96%b9)
    - [步骤3.1 终止已经存在的节点](#%e6%ad%a5%e9%aa%a431-%e7%bb%88%e6%ad%a2%e5%b7%b2%e7%bb%8f%e5%ad%98%e5%9c%a8%e7%9a%84%e8%8a%82%e7%82%b9)
    - [步骤3.2 开启节点](#%e6%ad%a5%e9%aa%a432-%e5%bc%80%e5%90%af%e8%8a%82%e7%82%b9)
    - [步骤3.3 开启`gdx`控制台](#%e6%ad%a5%e9%aa%a433-%e5%bc%80%e5%90%afgdx%e6%8e%a7%e5%88%b6%e5%8f%b0)
    - [步骤3.4 创建账号并开始挖矿](#%e6%ad%a5%e9%aa%a434-%e5%88%9b%e5%bb%ba%e8%b4%a6%e5%8f%b7%e5%b9%b6%e5%bc%80%e5%a7%8b%e6%8c%96%e7%9f%bf)
    - [步骤3.5 解锁账户](#%e6%ad%a5%e9%aa%a435-%e8%a7%a3%e9%94%81%e8%b4%a6%e6%88%b7)
    - [步骤3.6 检查余额](#%e6%ad%a5%e9%aa%a436-%e6%a3%80%e6%9f%a5%e4%bd%99%e9%a2%9d)
    - [步骤3.7 存储委托方设置](#%e6%ad%a5%e9%aa%a437-%e5%ad%98%e5%82%a8%e5%a7%94%e6%89%98%e6%96%b9%e8%ae%be%e7%bd%ae)
    - [步骤3.8 上传文件](#%e6%ad%a5%e9%aa%a438-%e4%b8%8a%e4%bc%a0%e6%96%87%e4%bb%b6)
    - [步骤3.9 上传进度](#%e6%ad%a5%e9%aa%a439-%e4%b8%8a%e4%bc%a0%e8%bf%9b%e5%ba%a6)
    - [步骤3.10 下载文件](#%e6%ad%a5%e9%aa%a4310-%e4%b8%8b%e8%bd%bd%e6%96%87%e4%bb%b6)
    - [步骤3.11 验证文件](#%e6%ad%a5%e9%aa%a4311-%e9%aa%8c%e8%af%81%e6%96%87%e4%bb%b6)
  - [第四部分：存储提供方](#%e7%ac%ac%e5%9b%9b%e9%83%a8%e5%88%86%e5%ad%98%e5%82%a8%e6%8f%90%e4%be%9b%e6%96%b9)
    - [步骤4.1 终止已经存在的节点](#%e6%ad%a5%e9%aa%a441-%e7%bb%88%e6%ad%a2%e5%b7%b2%e7%bb%8f%e5%ad%98%e5%9c%a8%e7%9a%84%e8%8a%82%e7%82%b9)
    - [步骤4.2 开启节点](#%e6%ad%a5%e9%aa%a442-%e5%bc%80%e5%90%af%e8%8a%82%e7%82%b9)
    - [步骤4.3 开启`gdx`控制台](#%e6%ad%a5%e9%aa%a443-%e5%bc%80%e5%90%afgdx%e6%8e%a7%e5%88%b6%e5%8f%b0)
    - [步骤4.4 创建账号并开始挖矿](#%e6%ad%a5%e9%aa%a444-%e5%88%9b%e5%bb%ba%e8%b4%a6%e5%8f%b7%e5%b9%b6%e5%bc%80%e5%a7%8b%e6%8c%96%e7%9f%bf)
    - [步骤4.5 解锁账户](#%e6%ad%a5%e9%aa%a445-%e8%a7%a3%e9%94%81%e8%b4%a6%e6%88%b7)
    - [步骤4.6 检查余额](#%e6%ad%a5%e9%aa%a446-%e6%a3%80%e6%9f%a5%e4%bd%99%e9%a2%9d)
    - [步骤4.7 添加文件夹](#%e6%ad%a5%e9%aa%a447-%e6%b7%bb%e5%8a%a0%e6%96%87%e4%bb%b6%e5%a4%b9)
    - [步骤4.8 存储提供方声明](#%e6%ad%a5%e9%aa%a448-%e5%ad%98%e5%82%a8%e6%8f%90%e4%be%9b%e6%96%b9%e5%a3%b0%e6%98%8e)
  - [第五部分：干净启动](#%e7%ac%ac%e4%ba%94%e9%83%a8%e5%88%86%e5%b9%b2%e5%87%80%e5%90%af%e5%8a%a8)
  - [联络DX](#%e8%81%94%e7%bb%9cdx)

## 第一部分：准备工作

### 步骤1.1 获取`gdx`可执行文件

请使用[这个链接](https://forms.gle/ymb8XKUVKAo2fuTc9)发送DxChain Testnet3.0节点申请。当DX收到收到并审核通过您的申请后，DX将向您的邮箱发送一个可执行文件的下载链接。请您下载`gdx`可执行文件后将其文件名更改为`gdx`。完成重命名后请打开终端。  
**注意: 当前您所下载的可执行文件仅支持64位系统**

### 步骤1.2 迁移`gdx`可执行文件

在Home路径下创建`bin`文件夹，之后请将`gdx`可执行文件放入`bin`文件夹。您可以在打开的终端中输入以下命令以在Home路径下创建`bin`文件夹  
```shell
$ mkdir ~/bin
```

### 步骤1.3 验证`gdx`可执行文件

出于对安全的考虑，当您完成上述步骤后，您还需要验证所下载的文件是DX提供的文件。请在终端内输入以下命令。
```shell
$ cd ~/bin
$ shasum -a 256 gdx
```
如果您获得的哈希值与下列的哈希值相对应，即证明您所下载的可执行文件是由官方提供。如果您获得的哈希值与提供的哈希值不符，请立即删除您下载的可执行文件并发起一个新的下载链接请求。 
 
- Linux: `70d6267afc22156f32fc6252a21ffeeb9bd74ff9f1972e21f11601547772fd47 gdx`
- MacOS: `b4c7d5c241b99abc448ed29653cc6f6b22dcbfe0c9caca0b655edd91f3b77452 gdx`

### 步骤1.4 获取执行权限

若您未取得执行权限，您的系统将不会允许执行`gdx`文件。您可以在终端中输入以下命令以获取执行权限。
```shell
$ cd ~/bin
$ chmod +x gdx
```

### 步骤1.5 验证版本

您可以通过输入以下命令以验证版本。正确的版本应当是：`Version: 0.7.2-unstable`
```shell
$ ~/bin/gdx version
```
_恭喜您！您已经完成了所有的准备工作！_

## 第二部分：矿工

每一个节点，不管是存储提供方还是存储委托方，都可以继承矿工的功能。如果您不打算成为存储提供方或者存储委托方，您可以输入以下命令成为一名矿工。
```shell
$ ~/bin/gdx
```
**注意：存储委托方和存储提供方都具有矿工挖矿的功能。**

### 步骤2.1 开启节点

请在终端中输入以下命令以矿工身份开启节点。
```shell
$ ~/bin/gdx
```

### 步骤2.2 开启`gdx`控制台

请开启另一个终端，并输入以下命令。
```shell
$ ~/bin/gdx attach
```

### 步骤2.3 创建账号并开始挖矿

您需要创建一个账户并开启挖矿以获得DX通证。请在您刚刚打开的控制台中输入以下命令。
```js
> personal.newAccount("")
> miner.start()
```
**注意：为了方便您的使用体验，您用上方命令行生成的账号的密码为空。**

### 步骤2.4 停止挖矿

您可以在控制台中输入以下命令以停止挖矿。
```js
> miner.stop()
```

## 第三部分：存储委托方

存储委托方通过支付DX通证，从存储提供方租借空间，把自己的文件，安全的存到DX网络中，并在需要的时候，从DX网络中下载已经上传的文件。

您可以在终端中输入以下命令成为一名存储委托方。
```shell
$ ~/bin/gdx --storageclient
```

### 步骤3.1 终止已经存在的节点
**注意：如果您之前从未开启过任何`gdx`程序，请跳过此步骤。**

如果您之前开启过节点或者节点正在运行，请您务必终止节点。您可以在终端中输入`Ctrl + C`来终止节点。之后，您还需要[干净启动](#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B9%B2%E5%87%80%E5%90%AF%E5%8A%A8)节点。

### 步骤3.2 开启节点

完成上述操作后，您可以在终端中输入以下命令以存储委托方的身份开启节点。
```shell
$ ~/bin/gdx --storageclient
```
### 步骤3.3 开启`gdx`控制台

请开启另一个终端，并输入以下命令。
```shell
$ ~/bin/gdx attach
```
### 步骤3.4 创建账号并开始挖矿

您需要创建一个账户并开启挖矿以获得DX通证。请在您刚刚打开的控制台中输入以下命令。
```js
> personal.newAccount("")
> miner.start()
```
**注意：为了方便您的使用体验，您用上方命令行生成的账号的密码为空。**

### 步骤3.5 解锁账户

任何交易在账户处于上锁状态的时候都是不被允许的，因此，您需要通过在控制台中输入以下命令解锁账户。
```js
> personal.unlockAccount(eth.accounts[0], "", 0)
```

### 步骤3.6 检查余额

上面提到，您需要向存储提供方支付DX通证以获取服务，如果您还未获得任何DX通证，请先通过挖矿获取DX通证。您可以通过在控制台中输入以下命令查看余额。
```js
> eth.getBalance(eth.accounts[0])
```
当您的余额不是0的时候，您可以继续接下来的操作。

**注意：在您执行*步骤3.7 委托方设定*之前请确保您已经和至少三个存储提供方连接，并且存储提供方的版本为*1.0.1*。您可以通过在控制台输入以下命令查看存储提供方的数量和版本。**
```shell
sclient.hosts
```

### 步骤3.7 存储委托方设置

在您和存储提供方建立合约之前，您必须先进行存储委托方的设置。不用担心，DX已经为您准备好了一套默认设定，您只需要在控制台中输入以下命令即可。
```js
> sclient.setconfig({})
```

接下来请您稍作等待，您的节点此时正在与存储提供方节点建立合约，你可以通过在控制台输入以下命令查看已经建立的合约数量，当合约数量为3的时候您可以进行下一步操作。
```js
> sclient.contracts.length
```
如果您在输入以上命令时控制台返回一个错误，不要担心，这说明还没有存储提供方与您建立合约。这可能需要一小会儿，请您稍作等待

### 步骤3.8 上传文件

在上传文件之前，请您先在终端中输入以下命令，在Home路径下创建一个名为 upload.file 的文件。文件大小为 512KB。
```shell
$ cd ~
$ dd if=/dev/urandom of=upload.file count=512 bs=1024
```
接下来，请取得您将要上传的文件的绝对路径，你可以在终端输入以下命令。
```shell
$ cd ~
$ ls "`pwd`/upload.file"
```

接下来，请您在控制台中输入以下命令。

**注意：请把 FILE_PATH 替换成您刚刚取得的文件绝对路径。**

```js
> sclient.upload("FILE_PATH", "download.file")
```


### 步骤3.9 上传进度

您可以通过在控制台输入以下命令来查看上传进度。
```js
> sclient.files
```
当文件上传进度到达100%时，您可以继续下一步的操作。

### 步骤3.10 下载文件

当文件完成上传后，您就可以下载该文件。你需要在终端中输入以下命令来获取您的Home路径的绝对路径，以便于将文件下载到Home路径下。
```shell
$ cd ~
$ pwd
```

之后请在控制台中输入以下命令。

**注意：请把FILE_PATH 替换成您刚刚取得的文件绝对路径。**

```js
> sclient.download("download.file", "FILE_PATH/download.file")
```

请您稍等片刻，一个名为`download.file`的文件将会被下载到您的Home路径下。

### 步骤3.11 验证文件

因为您上传的文件是一个随机生成的文件，如果您想检查下载下来的文件是否与上传的文件是同一个文件，您可以通过查看两个文件的哈希值来确认。请在终端中输入以下命令。
```shell
$ cd ~
$ shasum -a 256 upload.file
$ shasum -a 256 download.file
```
如果`upload.file`的哈希值与`download.file`的哈希值一样，则代表两个文件为同一文件。

## 第四部分：存储提供方

存储提供方为存储服务的提供者。存储提供方可以通过为存储委托方提供存储空间盈利。

您可以通过在终端中输入以下命令以存储提供方的身份开启节点。
```shell
$ ~/bin/gdx --storagehost
```
### 步骤4.1 终止已经存在的节点
**注意：如果您之前从未开启过任何`gdx`程序，请跳过此步骤。**

如果您之前开启过节点或者节点正在运行，请您务必终止节点。您可以在终端中输入`Ctrl + C`来终止节点。之后，您还需要[干净启动](#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B9%B2%E5%87%80%E5%90%AF%E5%8A%A8)节点。

### 步骤4.2 开启节点

您可以在终端中输入以下命令以存储提供方的身份开启节点。
```shell
$ ~/bin/gdx --storagehost
```
### 步骤4.3 开启`gdx`控制台

请开启另一个终端，并输入以下命令。
```shell
$ ~/bin/gdx attach
```

### 步骤4.4 创建账号并开始挖矿

您需要创建一个账户并开启挖矿以获得DX通证。请在您刚刚打开的控制台中输入以下命令。
```js
> personal.newAccount("")
> miner.start()
```
**注意：为了方便您的使用体验，您用上方命令行生成的账号的密码为空。**

### 步骤4.5 解锁账户

任何交易在账户处于上锁状态的时候都是不被允许的，因此，您需要通过在控制台中输入以下命令解锁账户。
```js
> personal.unlockAccount(eth.accounts[0], "", 0)
```

### 步骤4.6 检查余额

上面提到，您需要向存储提供方支付DX通证以获取服务，如果您还未获得任何DX通证，请先通过挖矿获取DX通证。您可以通过在控制台中输入以下命令查看余额。
```js
> eth.getBalance(eth.accounts[0])
```
当您的余额不是0的时候，您可以继续接下来的操作。

### 步骤4.7 添加文件夹

为了使存储委托方可以正常的使用存储服务，您必须先对您的硬盘空间进行分配。在控制台中请您输入以下命令。这行命令将会在您的Home路径下创建一个大小为1gb，文件名为`temp`的文件夹，在`temp`文件夹下将会出现一个`dxchain`文件夹，里面包括了一些必要的文件。
```js
> shost.addFolder("~/temp/dxchain", "1gb")
```

### 步骤4.8 存储提供方声明

最后，您必须进行声明以供其他节点知晓您是一个存储提供方节点。通过在控制台中输入以下命令，存储委托方将知晓您是存储提供方。
```js
> shost.announce()
```



## 第五部分：干净启动

当您希望转换身份的时候，您都应该在节点启动前执行此步骤。此步骤将会清理所有与您之前身份有关的数据。
* For macOS: `rm -r ~/Library/DxChain`
* For linux: `rm -r ~/.dxchain`  

当您完成上述操作后，您可以以您想要的身份开启一个新的节点。

## 联络DX

非常感谢您对DX项目的支持与信心。如果您有任何疑问，请通过 support@dxchain.com 联络DX。
